<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Example · FieldTracer.jl</title><meta name="title" content="Example · FieldTracer.jl"/><meta property="og:title" content="Example · FieldTracer.jl"/><meta property="twitter:title" content="Example · FieldTracer.jl"/><meta name="description" content="Documentation for FieldTracer.jl."/><meta property="og:description" content="Documentation for FieldTracer.jl."/><meta property="twitter:description" content="Documentation for FieldTracer.jl."/><meta property="og:url" content="https://henry2004y.github.io/FieldTracer.jl/example/"/><meta property="twitter:url" content="https://henry2004y.github.io/FieldTracer.jl/example/"/><link rel="canonical" href="https://henry2004y.github.io/FieldTracer.jl/example/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">FieldTracer.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Example</a><ul class="internal"><li><a class="tocitem" href="#Structured-2D-mesh"><span>Structured 2D mesh</span></a></li><li><a class="tocitem" href="#Unstructured-2D-mesh"><span>Unstructured 2D mesh</span></a></li><li><a class="tocitem" href="#Structured-3D-mesh"><span>Structured 3D mesh</span></a></li><li><a class="tocitem" href="#Seeding"><span>Seeding</span></a></li><li><a class="tocitem" href="#Parallelization"><span>Parallelization</span></a></li><li><a class="tocitem" href="#Arrow"><span>Arrow</span></a></li><li><a class="tocitem" href="#Gallery"><span>Gallery</span></a></li></ul></li><li><a class="tocitem" href="../log/">Log</a></li><li><a class="tocitem" href="../internal/">Internal</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Example</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Example</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/henry2004y/FieldTracer.jl/blob/master/docs/src/example.md#L" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Examples"><a class="docs-heading-anchor" href="#Examples">Examples</a><a id="Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Examples" title="Permalink"></a></h1><p>There is one higher level function API, <a href="https://henry2004y.github.io/FieldTracer.jl/dev/internal/#FieldTracer.trace-Tuple">trace</a>, for tracing on a 2D and 3D mesh. This function accepts different types of input mesh arguments.<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup> The default scheme is 4th order Runge-Kutta method <code>RK4()</code>, but users can also switch to other options like 2nd order Euler method <code>Euler()</code>.<sup class="footnote-reference"><a id="citeref-2" href="#footnote-2">[2]</a></sup> User can also specify the maximum number of tracing steps via keyword <code>maxstep</code>, the step size in normalized coordinates [0,1] <code>ds</code>, order of grid <code>gridtype</code>, and tracing directions <code>direction</code> chosen between <code>&quot;both&quot;,&quot;forward&quot;,&quot;backward&quot;</code>.</p><p>More examples can be found in the <a href="https://github.com/henry2004y/FieldTracer.jl/tree/master/src/examples">examples</a> folder.</p><h2 id="Structured-2D-mesh"><a class="docs-heading-anchor" href="#Structured-2D-mesh">Structured 2D mesh</a><a id="Structured-2D-mesh-1"></a><a class="docs-heading-anchor-permalink" href="#Structured-2D-mesh" title="Permalink"></a></h2><pre><code class="language-julia hljs">using FieldTracer
x = range(0, 1, step=0.1)
y = range(0, 1, step=0.1)
# ndgrid
gridx = [i for i in x, _ in y]
gridy = [j for _ in x, j in y]
u = copy(gridx)
v = -copy(gridy)
startx = 0.1
starty = 0.9
trace(u, v, startx, starty, x, y)</code></pre><h2 id="Unstructured-2D-mesh"><a class="docs-heading-anchor" href="#Unstructured-2D-mesh">Unstructured 2D mesh</a><a id="Unstructured-2D-mesh-1"></a><a class="docs-heading-anchor-permalink" href="#Unstructured-2D-mesh" title="Permalink"></a></h2><p>See the example in <a href="https://github.com/henry2004y/FieldTracer.jl/tree/master/test/test_unstructured.jl">test_unstructured.jl</a>.</p><h2 id="Structured-3D-mesh"><a class="docs-heading-anchor" href="#Structured-3D-mesh">Structured 3D mesh</a><a id="Structured-3D-mesh-1"></a><a class="docs-heading-anchor-permalink" href="#Structured-3D-mesh" title="Permalink"></a></h2><p>Tracing on a structured 3D mesh is a natural extension from 2D.</p><pre><code class="language-julia hljs">using FieldTracer, Meshes
x = range(0, 10, length=15)
y = range(0, 10, length=20)
z = range(0, 10, length=25)
bx = fill(1.0, length(x), length(y), length(z))
by = fill(1.0, length(x), length(y), length(z))
bz = fill(1.0, length(x), length(y), length(z))
xs, ys, zs = 1.0, 1.0, 1.0
Δx = x[2] - x[1]
Δy = y[2] - y[1]
Δz = z[2] - z[1]
grid = CartesianGrid((length(x)-1, length(y)-1, length(z)-1),
   (0., 0., 0.),
   (Δx, Δy, Δz))

# default direction is both
x1, y1, z1 = trace(bx, by, bz, xs, ys, zs, grid; alg=Euler(), ds=0.2, maxstep=200)</code></pre><h2 id="Seeding"><a class="docs-heading-anchor" href="#Seeding">Seeding</a><a id="Seeding-1"></a><a class="docs-heading-anchor-permalink" href="#Seeding" title="Permalink"></a></h2><p>We provide a function <a href="https://henry2004y.github.io/FieldTracer.jl/dev/internal/#FieldTracer.select_seeds-Tuple{Any,%20Any}">select_seeds</a> for generating uniform seeds for the starting points in 2D/3D. This ensures consistent sampling of fieldlines across the same points to reduce visual shift effect across multiple frames.</p><p>Furthermore, we can select seeds interactively on the figure and plot on-the-fly. See the example <a href="https://github.com/henry2004y/FieldTracer.jl/tree/master/examples/demo_interactive_select.jl">demo_interactive_select.jl</a>.</p><h2 id="Parallelization"><a class="docs-heading-anchor" href="#Parallelization">Parallelization</a><a id="Parallelization-1"></a><a class="docs-heading-anchor-permalink" href="#Parallelization" title="Permalink"></a></h2><p>Parallelized tracing can happen at fieldline level, whereas it can be less efficient to do it per line. We recommend providing a bunch of points to the <code>trace</code> function and then collecting results:</p><pre><code class="language-julia hljs">linex, liney = zeros(20,10), zeros(20,10)
Threads.@threads for i = 1:10
   lx, ly = trace(u, v, startx, starty, x, y, maxstep=20)
   linex[1:length(lx),i] = lx
   liney[1:length(ly),i] = ly
end</code></pre><h2 id="Arrow"><a class="docs-heading-anchor" href="#Arrow">Arrow</a><a id="Arrow-1"></a><a class="docs-heading-anchor-permalink" href="#Arrow" title="Permalink"></a></h2><p>When plotting, it is usually convenient to display an arrow along the line for showing the direction. Currently we provide a function <a href="https://henry2004y.github.io/FieldTracer.jl/dev/internal/#FieldTracer.add_arrow">add_arrow</a> which acts on a Matplotlib Line2D object and adds an arrow for it.<sup class="footnote-reference"><a id="citeref-3" href="#footnote-3">[3]</a></sup></p><h2 id="Gallery"><a class="docs-heading-anchor" href="#Gallery">Gallery</a><a id="Gallery-1"></a><a class="docs-heading-anchor-permalink" href="#Gallery" title="Permalink"></a></h2><ul><li>Tracing in an analytic asymptotic field</li></ul><p><img src="../figures/trace_asymptote.png" alt/></p><ul><li>Tracing in a analytic 3D dipole field</li></ul><p><img src="../figures/trace_dipole.png" alt/></p><ul><li>Tracing in a numerical 2D magnetic field</li></ul><p><img src="../figures/BxBz_y0cut.png" alt/></p><ul><li>Tracing in a 2D equatorial plane Earth magnetosphere simulation</li></ul><p><img src="../figures/trace_streamline_2Dmagnetosphere.png" alt/></p><ul><li>Streamline tracing in a 2D triangular mesh around an airfoil</li></ul><p><img src="../figures/trace_streamline_2Dunstructured.png" alt/></p><p>An example is shown for the 2D streamline tracing in the unstructured triangular mesh for the famous airfoil problem. The blue lines are the analytic stream functions derived from incompressible Euler equations which are calculated numerically. Three colored lines are displayed with dots representing the footprints inside each cell.</p><ul><li>Fieldline tracing near the magnetic null points, compared to the <code>streamplot</code> function in Matplotlib</li></ul><p><img src="../figures/x_o_point.png" alt/></p><ul><li>Fieldline tracing near Ganymede&#39;s upstream magnetopause</li></ul><p><img src="../figures/trace_magnetopause_ganymede.png" alt/></p><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a>Currently 3D tracing is only limited to structured mesh.</li><li class="footnote" id="footnote-2"><a class="tag is-link" href="#citeref-2">2</a>The scheme switch currently only works for Cartesian grid.</li><li class="footnote" id="footnote-3"><a class="tag is-link" href="#citeref-3">3</a>3D arrow is not supported due to the limitation of Matplotlib. It is possible, but tedious.</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../log/">Log »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Monday 5 February 2024 15:50">Monday 5 February 2024</span>. Using Julia version 1.10.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
